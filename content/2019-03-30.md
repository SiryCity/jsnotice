---
title: "【CSS】100vhは「一画面」ではないという罠"
date: "2019-03-30"
draft: false
url: "posts/2019-03-30"
tags: ['CSS',]
---

こんにちは!今日はCSSの単位の一つ「vh」~~の厄介すぎる仕様~~について話したいと思います。

## vh

vh(view height)はCSS3で策定された単位の一つで、ざっくり言うと「画面の高さ」です。ちなみ横幅はvw(view width)です。

vhは百分率で表されます。50vhなら画面の見える高さの半分ですね。
縦幅1000pxのスマホなら、
```javascript
100vh = 1000px
```
になります。


よく使うケースとしては、クラス.fooを持つ要素を画面一杯に表示したい時に...

```css
.foo{
  width: 100vw;
  height: 100vh;
}
```

といった感じです。

## 画面一杯なら100%でよくない?

ごもっともです!

ですが、 %はあくまで「親要素のn%」。例えばこのようにクラス.childのheightが100%だった場合、

```css
.child{
  height: 100%;
}
```

このchildの画面上での高さは親要素を見なければ分かりません。しかし親要素も%だったりする場合が往々にしてあるわけです。こんな感じに...

```css
.parent{
  height: 50%;
}
.child{
  height: 100%;
}
```

この場合は更に親要素の確認が必要です。こんなケースは結構あるんじゃないでしょうかね？
端的に言えば、サイズが親に依存するわけです。一方、vhは...
```css
.child{
  height: 100vh;
}
```
100vhならば、親がいようとなかろうと実親と育ての親が違おうと100vhです。画面一杯です。

vhは適切に用いることでCSSをシンプルにします。特にページのファーストビューに対して100vhを指定するのは
とても良いアイデアだと思います。そんな素敵なvhですが、思わぬ罠が...

## 100vhは「一画面」ではない

vhは「画面の高さ」です。...が、vhの罠の一つとして「一画面でない」点が挙げられます。
画面の縦幅が1000pxであっても、常に「100vh = 1000px = ぴったり一画面」 であると思いませんか?しかし、そうではないのです...

### アドレスバーの分押し出される

このページをスマホで見ている人は画面上の方にURLとか書いてませんか?いわゆるアドレスバーと呼ばれる部分です。

アドレスバーはWebサイトでは(現在は)必ず表示され、Webサイト本体が表示される領域を狭めます。例えば縦1000pxのスマホに60pxのアドレスバーがあった場合、サイト一画面は...

```
一画面
= 1000px - 60px
= 940px
```

となります。

この時、画面いっぱいに表示したい要素は縦何pxにするべきでしょうか??
勿論940pxですね!

一方、100vhはというと...
```
100vh = 1000px
```

1000pxのままです。それもそのはず、vhは「見える部分の高さ」であり、「コンテンツ部分の高さ」ではないのです。したがって、この場合画面いっぱいに表示したい要素に100vhを付けると60pxぶん画面からはみ出します。

```
100vh ≠ 一画面
100vh - アドレスバー = 一画面
```

ならば、最初からアドレスバーの分を削って97vhくらいにしたらどうでしょう?

残影ながらこれも駄目。アドレスバーは厄介なことに大抵の機種ではスクロールすると引っ込むんです...
当然、アドレスバーが引っ込んだ後では97vhで画面全体は覆えません。

追い打ちをかけると、そもそもアドレスバーの長さは機種によりまちまちです。

この仕様の被害を最も被るのがファーストビューでしょう。ページを開いた瞬間に画面一杯に表示したい画像に
height: 100vh を指定すると、画面に表示されるのは約97vh分だけです。メニューバーの分は見切れてしまいます。

### キーボードが出ると圧縮される

スマホで文字入力をする時に使うキーボードもvhは含みません。フォーム系のレイアウトにvhを使うと、
文字を入力しようとした瞬間にフォームが急激に縮むカオスな状況が見られます。

## 問題と解決策

これらのケースから、vhの問題は「スマホにおいてアドレスバー等を考慮しない点」と言えるでしょう。

そして、これを解決するために必要なのは
「画面の高さからアドレスバーの高さを除いた値を知る方法」だということが言えます。

というわけで次回は「ファーストビューを綺麗に出すCSS+JavaScriptテクニック」みたいな内容を書きたいと思います。おわり!

【追記】(2019/05/22)一部修正しました。[続き](https://jsnotice.com/posts/2019-04-03)